<h1 class="mt-3 d-flex justify-content-between align-items-center">Join A Game<button class="btn btn-primary" style="padding: 10px;" onclick="loadContent('create');">Create</button></h1>

<ul id="room_list" class="list-group list-group-flush"></ul>

<div id="room-loader" class="spinner-border mx-auto mt-5 text-primary" role="status" style="display: block; width: 5rem; height: 5rem;">
    <span class="sr-only">Loading...</span>
</div>

<script>
//Get list of open rooms
firebase.database().ref('/rooms/').once('value').then( (data) => {
    var room_list = firebase.database().ref('/rooms/');
    $('#room-loader').hide();

    room_list.on('child_added', (data) => {
        $('#room_list').append(`
            <div id="room_${ data.key }" class="room-item d-flex">
                <li class="list-group-item list-group-item-dark list-group-item-action d-flex justify-content-between align-items-center">
                    ${ data.key }
                    ${ data.val().full === false ? `
                        <span>${ data.val().players }/${ data.val().max }</span>
                    ` : '<span>Full</span>' }
                </li>
                ${ data.val().full === false ? `
                <button class="btn btn-primary list-btn" onclick="join('${ data.key }');">Join</button>
                ` : '<button class="btn btn-primary list-btn disabled">Join</button>' }
            </div>
        `);
        noRooms();
    });

    noRooms();

}).catch( (error) => {

});

function noRooms() {
    if ($('#room_list').children().length === 0)
        $('#room_list').after(`<div id="no_room_error" class="text-center alert alert-danger">No rooms were found.</div>`);
    else
        $('#no_room_error').remove();
}
</script>

<style>

</style>